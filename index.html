<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Stock Farmer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#000000" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="icon" href="images/logo/favicon.ico" />
  <link rel="apple-touch-icon" sizes="512x512" href="images/logo/pwa-512.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="assets/css/main.css" />
</head>

<body class="bg-black text-white">
  <nav class="farm-bg text-white farm-border border-b">
    <div class="flex flex-wrap items-center gap-3 px-5 py-3 relative">
      <a class="text-base font-semibold whitespace-nowrap" href="#">Stock Farmer</a>

      <div class="ml-auto flex items-center gap-3">
        <button id="userBadge" type="button"
          class="flex items-center gap-3 farm-bg-light border farm-border rounded-full px-4 py-2 shadow-lg cursor-pointer focus:outline-none hover:border-opacity-80">
          <svg class="h-5 w-5 text-neutral-300" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="1.6">
            <circle cx="12" cy="8" r="4" />
            <path d="M5 19c0-3.3 3.1-6 7-6s7 2.7 7 6" />
          </svg>
          <span id="auth-state" class="text-sm font-semibold text-white whitespace-nowrap">Guest</span>
        </button>
        <button id="navToggle"
          class="inline-flex items-center justify-center p-3 rounded-md border farm-border farm-btn focus:outline-none"
          type="button" aria-controls="navOffcanvas" aria-expanded="false">
          <span class="sr-only">Open controls</span>
          <svg class="h-5 w-5" viewBox="0 0 20 20" fill="none">
            <path d="M3 5h14M3 10h14M3 15h14" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
          </svg>
        </button>
      </div>
    </div>
  </nav>

  <div id="navOverlay" class="fixed inset-0 bg-black/50 hidden z-30"></div>

  <div id="navOffcanvas"
    class="fixed inset-y-0 right-0 w-72 max-w-full farm-bg text-white shadow-2xl transform translate-x-full transition-transform duration-200 z-40 flex flex-col">
    <div class="flex items-center justify-between px-5 py-4 border-b farm-border">
      <h5 class="text-base font-semibold farm-text" id="navOffcanvasLabel">Settings</h5>
      <button id="navClose" class="p-2 rounded-lg farm-btn focus:outline-none border farm-border">
        <span class="sr-only">Close</span>
        <svg class="h-4 w-4" viewBox="0 0 20 20" fill="none" aria-hidden="true">
          <path d="M5 5l10 10M15 5L5 15" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
        </svg>
      </button>
    </div>
    <div class="flex-1 p-5 text-sm farm-text-secondary space-y-4 overflow-y-auto farm-bg offcanvas-scroll">
      <div class="rounded-xl border farm-border farm-bg-card p-4 space-y-3 shadow-inner shadow-black/20">
        <div class="flex items-center gap-3">
          <div
            class="flex items-center justify-center h-10 w-10 rounded-full farm-bg-light border farm-border farm-text-secondary">
            <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
              <circle cx="12" cy="8" r="4" />
              <path d="M5 19c0-3.3 3.1-6 7-6s7 2.7 7 6" />
            </svg>
          </div>
          <div class="min-w-0">
            <p id="offcanvasUsername" class="text-sm font-semibold farm-text truncate">Guest</p>
          </div>
        </div>
        <div class="space-y-2">
          <button id="authTrigger"
            class="w-full text-sm font-semibold px-3 py-2 rounded-md btn-accent focus:outline-none">
            Log In
          </button>
          <button id="logoutBtn"
            class="w-full text-sm font-semibold px-3 py-2 rounded-md btn-accent focus:outline-none hidden">Log
            Out</button>
        </div>
      </div>





      <div id="hudCardSlot"></div>

      <div id="themeCardSlot"></div>

      <div class="rounded-xl border farm-border farm-bg-card p-4 shadow-inner shadow-black/20 space-y-2">
        <p class="text-xs uppercase tracking-wide farm-text-secondary mb-2">Admin</p>
        <button
          class="w-full border farm-border farm-btn farm-text text-sm font-semibold px-3 py-2 rounded-md flex items-center justify-center text-center"
          id="recenterBtn">
          Recenter View
        </button>
        <button
          class="w-full border farm-border farm-btn farm-text text-sm font-semibold px-3 py-2 rounded-md flex items-center justify-center text-center"
          id="installBtn" disabled>
          Install App
        </button>
        <button
          class="w-full border farm-border farm-btn farm-text text-sm font-semibold px-3 py-2 rounded-md flex items-center justify-center text-center"
          id="resetSettingsBtn">
          Reset Settings
        </button>

        <button
          class="w-full border farm-border farm-btn farm-text text-sm font-semibold px-3 py-2 rounded-md flex items-center justify-center text-center"
          id="clearCacheBtn">
          Clear Cache
        </button>
        <button
          class="w-full border border-red-700 text-sm font-semibold px-3 py-2 rounded-md hover:bg-red-800/80 bg-red-800/40 flex items-center justify-center text-center"
          id="resetFarmBtn">
          Reset Progress
        </button>
        <div id="moneyCheatCard" class="hidden pt-2">
          <div class="flex items-center gap-2">
            <input id="moneyCheatInput" type="number" min="0" step="1000"
              class="w-full rounded-md farm-input px-3 py-2 text-sm" placeholder="$100000" />
            <button id="moneyCheatApply" type="button"
              class="px-3 py-2 rounded-md btn-accent text-sm font-semibold focus:outline-none">
              Apply
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="authModal" class="fixed inset-0 z-[60] hidden" role="dialog" aria-modal="true"
    aria-labelledby="authModalTitle">
    <div id="authModalOverlay" class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
    <div class="relative z-10 flex min-h-full items-center justify-center px-4 py-6">
      <div class="w-full max-w-3xl farm-bg-card border farm-border rounded-2xl shadow-2xl overflow-hidden">
        <div class="flex items-center justify-between px-5 py-4 border-b farm-border farm-bg">
          <h2 id="authModalTitle" class="text-lg font-semibold farm-text">Log In</h2>
          <button id="authModalClose" class="p-2 rounded-full farm-btn farm-text-secondary focus:outline-none">
            <span class="sr-only">Close</span>
            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.6">
              <path d="M5 5l10 10M15 5L5 15" stroke-linecap="round" />
            </svg>
          </button>
        </div>
        <div class="px-5 pt-4 farm-bg">
          <div class="flex gap-2" role="tablist" aria-label="Authentication">
            <button id="tab-login"
              class="flex-1 text-sm font-semibold rounded-md px-3 py-2 border transition-colors farm-bg-light farm-text farm-border shadow"
              type="button" role="tab" aria-selected="true" aria-controls="panel-login" tabindex="0">
              Existing User
            </button>
            <button id="tab-signup"
              class="flex-1 text-sm font-semibold rounded-md px-3 py-2 border transition-colors bg-transparent farm-text-secondary farm-border hover:farm-text"
              type="button" role="tab" aria-selected="false" aria-controls="panel-signup" tabindex="-1">
              Create Account
            </button>
          </div>
        </div>
        <div class="px-5 py-5 farm-bg max-h-[70vh] overflow-y-auto">
          <div id="panel-login" class="space-y-4" role="tabpanel" aria-labelledby="tab-login" aria-hidden="false"
            tabindex="0">
            <form id="login-form" class="space-y-3" autocomplete="on">
              <div class="space-y-1">
                <label class="text-[11px] uppercase tracking-wide farm-text-secondary" for="login-email">Email</label>
                <input id="login-email" name="email" type="email" inputmode="email" autocomplete="username"
                  autocapitalize="none" spellcheck="false" class="w-full rounded-md farm-input px-3 py-2 text-base"
                  placeholder="you@example.com" required />
              </div>
              <div class="space-y-1">
                <label class="text-[11px] uppercase tracking-wide farm-text-secondary"
                  for="login-password">Password</label>
                <input id="login-password" name="password" type="password" autocomplete="current-password"
                  class="w-full rounded-md farm-input px-3 py-2 text-base" placeholder="********" required />
              </div>
              <button type="submit" class="w-full btn-accent text-sm font-semibold rounded-md px-4 py-2 transition">Log
                In</button>
              <p id="login-error" class="text-xs text-red-400 min-h-[1rem]" aria-live="polite"></p>
              <div class="flex items-center justify-between">
                <button type="button" id="reset-password" class="text-xs text-accent-soft hover:text-accent">Forgot
                  password?</button>
                <p id="reset-message" class="text-[11px] text-accent-soft" aria-live="polite"></p>
              </div>
            </form>
          </div>
          <div id="panel-signup" class="space-y-4 hidden" role="tabpanel" aria-labelledby="tab-signup"
            aria-hidden="true" tabindex="-1">
            <form id="signup-form" class="space-y-3" autocomplete="on">
              <div class="space-y-1">
                <label class="text-[11px] uppercase tracking-wide farm-text-secondary"
                  for="signup-username">Username</label>
                <input id="signup-username" name="username" type="text" autocomplete="username" autocapitalize="none"
                  spellcheck="false" class="w-full rounded-md farm-input px-3 py-2 text-base" placeholder="Farmer" />
              </div>
              <div class="space-y-1">
                <label class="text-[11px] uppercase tracking-wide farm-text-secondary" for="signup-email">Email</label>
                <input id="signup-email" name="email" type="email" inputmode="email" autocomplete="email"
                  autocapitalize="none" spellcheck="false" class="w-full rounded-md farm-input px-3 py-2 text-base"
                  placeholder="you@example.com" required />
              </div>
              <div class="space-y-1">
                <label class="text-[11px] uppercase tracking-wide farm-text-secondary"
                  for="signup-password">Password</label>
                <input id="signup-password" name="password" type="password" autocomplete="new-password"
                  class="w-full rounded-md farm-input px-3 py-2 text-base" placeholder="********" required />
              </div>
              <button type="submit"
                class="w-full btn-accent text-sm font-semibold rounded-md px-4 py-2 transition">Create
                Account</button>
              <p id="signup-error" class="text-xs text-red-400 min-h-[1rem]" aria-live="polite"></p>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="confirmModal"
    class="fixed inset-0 z-50 bg-black/70 backdrop-blur-sm flex items-center justify-center px-3 py-6 hidden">
    <div class="w-full max-w-sm farm-bg-card border farm-border rounded-lg shadow-2xl overflow-hidden">
      <div class="flex items-center justify-between px-4 py-3 border-b farm-border">
        <h3 id="confirmTitle" class="text-sm font-semibold farm-text">Confirm</h3>
        <button id="confirmClose" class="p-1 rounded-md farm-btn focus:outline-none">
          <span class="sr-only">Close</span>
          <svg class="h-4 w-4" viewBox="0 0 20 20" fill="none" aria-hidden="true">
            <path d="M5 5l10 10M15 5L5 15" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div id="confirmMessage" class="px-4 py-4 text-sm farm-text leading-relaxed"></div>
      <div class="px-4 pb-4 flex gap-2">
        <button id="confirmConfirm"
          class="w-1/2 py-2 rounded-md btn-accent text-sm font-semibold focus:outline-none">Yes</button>
        <button id="confirmCancel"
          class="w-1/2 py-2 rounded-md border border-red-700 bg-red-700/70 text-white text-sm font-medium hover:bg-red-600 focus:outline-none">No</button>
      </div>
    </div>
  </div>

  <div id="resetModal"
    class="fixed inset-0 z-[65] bg-black/70 backdrop-blur-sm flex items-center justify-center px-3 py-6 hidden">
    <div class="w-full max-w-md farm-bg-card border farm-border rounded-2xl shadow-2xl overflow-hidden">
      <div class="flex items-center justify-between px-5 py-4 border-b farm-border farm-bg">
        <div>
          <p class="text-[11px] uppercase tracking-wide farm-text-secondary">Password reset</p>
          <h3 class="text-lg font-semibold farm-text">Send reset link</h3>
        </div>
        <button id="resetClose" class="p-2 rounded-full farm-btn farm-text-secondary focus:outline-none">
          <span class="sr-only">Close</span>
          <svg class="h-4 w-4" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.6">
            <path d="M5 5l10 10M15 5L5 15" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="px-5 py-5 space-y-3">
        <p class="text-sm farm-text-secondary">Enter your account email address</p>
        <div class="space-y-1">
          <label class="text-[11px] uppercase tracking-wide farm-text-secondary" for="reset-email">Email</label>
          <input id="reset-email" name="email" type="email" inputmode="email" autocomplete="email" autocapitalize="none"
            spellcheck="false" class="w-full rounded-md farm-input px-3 py-2 text-base" placeholder="you@example.com" />
        </div>
        <p id="reset-modal-status" class="text-xs min-h-[1rem] text-neutral-300" aria-live="polite"></p>
      </div>
      <div class="px-5 pb-5 flex gap-2">
        <button id="resetSend" class="w-full btn-accent text-sm font-semibold rounded-md px-4 py-2 transition">Send
          reset email</button>
      </div>
    </div>
  </div>

  <div id="logoutModal"
    class="fixed inset-0 z-[65] bg-black/70 backdrop-blur-sm flex items-center justify-center px-3 py-6 hidden">
    <div class="w-full max-w-sm farm-bg-card border farm-border rounded-lg shadow-2xl overflow-hidden">
      <div class="flex items-center justify-between px-4 py-3 border-b farm-border">
        <h3 class="text-sm font-semibold farm-text">Confirm</h3>
        <button id="logoutClose" class="p-1 rounded-md farm-btn focus:outline-none">
          <span class="sr-only">Close</span>
          <svg class="h-4 w-4" viewBox="0 0 20 20" fill="none" aria-hidden="true">
            <path d="M5 5l10 10M15 5L5 15" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="px-4 py-4 text-sm farm-text leading-relaxed">Log Out?</div>
      <div class="px-4 pb-4 flex gap-2">
        <button id="logoutConfirm" class="w-1/2 py-2 rounded-md btn-accent text-sm font-semibold focus:outline-none">Log
          Out</button>
        <button id="logoutCancel"
          class="w-1/2 py-2 rounded-md border farm-border farm-btn farm-text text-sm font-medium focus:outline-none">
          Stay Signed In
        </button>
      </div>
    </div>
  </div>

  <div class="canvas-wrapper">
    <canvas id="gridCanvas"></canvas>
    <div id="htmlUiLegacy" class="hidden">
      <div id="moneyChangeDisplay"></div>
      <div id="totalDisplay">$0.00</div>
      <div id="plantDropdowns">
        <button id="plantCropButton" type="button"></button>
        <span id="plantCropLabel"></span>
        <img id="plantCropImage" alt="Crop" />
        <div id="plantCropMenu"></div>
        <button id="plantSizeButton" type="button"></button>
        <span id="plantSizeLabel"></span>
        <div id="plantSizeMenu"></div>
      </div>
      <div id="harvestDropdowns">
        <button id="harvestSizeButton" type="button"></button>
        <span id="harvestSizeLabel"></span>
        <div id="harvestSizeMenu"></div>
      </div>
      <div id="buildDropdowns">
        <button id="buildSelectButton" type="button"></button>
        <img id="buildSelectImage" alt="Build" />
        <span id="buildSelectLabel"></span>
        <div id="buildSelectMenu"></div>
      </div>
      <div id="landscapeDropdowns">
        <button id="landscapeSelectButton" type="button"></button>
        <img id="landscapeSelectImage" alt="Landscape" />
        <span id="landscapeSelectLabel"></span>
        <div id="landscapeSelectMenu"></div>
      </div>
      <button id="modePlantBtn" type="button"></button>
      <button id="modeHarvestBtn" type="button"></button>
      <button id="modeLandscapeBtn" type="button"></button>
      <button id="modeBuildBtn" type="button"></button>
      <button id="modeTradeBtn" type="button"></button>
    </div>
  </div>

  <div id="tradeModal" class="fixed inset-0 z-[70] hidden" role="dialog" aria-modal="true"
    aria-labelledby="tradeModalTitle">
    <div id="tradeOverlay" class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
    <div class="relative z-10 flex min-h-full items-center justify-center px-3 py-6">
      <div
        class="w-full max-w-6xl md:max-w-7xl max-h-[90vh] h-[90vh] farm-bg-card border farm-border rounded-2xl shadow-2xl overflow-hidden flex flex-col">
        <div class="flex items-center justify-between px-5 py-4 border-b farm-border farm-bg">
          <div>
            <p class="text-[11px] uppercase tracking-wide farm-text-secondary">Trading</p>
            <h2 id="tradeModalTitle" class="text-lg font-semibold farm-text">Market</h2>
          </div>
          <button id="tradeClose"
            class="p-2 rounded-full farm-btn farm-text-secondary focus:outline-none border farm-border">
            <span class="sr-only">Close</span>
            <svg class="h-4 w-4" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.6">
              <path d="M5 5l10 10M15 5L5 15" stroke-linecap="round" />
            </svg>
          </button>
        </div>
        <div class="px-5 py-5 farm-bg space-y-3 flex-1 overflow-auto flex flex-col">
          <div class="md:hidden flex rounded-full farm-bg-light p-1 text-[0.7rem]">
            <button id="tradeTab"
              class="flex-1 text-center py-1.5 rounded-full font-semibold farm-bg-card farm-text">Buy</button>
            <button id="positionsTab"
              class="flex-1 text-center py-1.5 rounded-full font-semibold text-neutral-400">Sell</button>
          </div>

          <div
            class="mt-1 flex flex-col md:grid md:grid-cols-2 md:gap-3 md:items-stretch flex-1 min-h-0 overflow-hidden">
            <section id="tradeSection"
              class="rounded-2xl farm-bg-card border farm-border p-3 flex-1 flex flex-col min-h-0 overflow-hidden">
              <div class="flex items-center justify-between gap-2 mb-1">
                <h3 class="text-xs font-semibold farm-text">Buy</h3>
                <div class="flex items-center gap-2">
                  <div class="text-right flex flex-col items-end gap-0.5">
                    <div class="text-[0.6rem] uppercase farm-text-secondary">Wallet</div>
                    <div class="flex items-center gap-1 leading-none">
                      <div id="tradeMoneyChange"
                        class="trade-delta text-[0.65rem] font-semibold text-emerald-300 opacity-0 transition-opacity duration-200 pointer-events-none">
                      </div>
                      <div class="text-xs font-semibold farm-text" id="tradeWalletValue">$0.00</div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="flex-1 flex flex-col min-h-0">
                <div class="rounded-lg farm-bg-card border farm-border flex-1 overflow-y-auto offcanvas-scroll">
                  <ul id="tickerList" class="divide-y divide-farm-border text-[0.75rem]"></ul>
                </div>

                <div class="space-y-1">
                  <div class="text-[0.65rem] farm-text-secondary">Shares</div>
                  <div class="flex items-stretch gap-2">
                    <button id="buyBtn"
                      class="w-32 rounded-xl btn-accent py-1.5 px-3 text-[0.75rem] font-semibold active:scale-[0.98] transition text-left">
                      Buy
                    </button>
                    <div class="flex-1 flex items-center gap-1.5">
                      <button id="decShares"
                        class="rounded-xl border farm-border farm-bg-light px-2 py-1.5 text-[0.75rem] font-semibold active:scale-[0.97] transition farm-text">
                        âˆ’
                      </button>
                      <input id="shareInput" type="text" readonly value="1"
                        class="w-full text-center rounded-xl farm-bg-light border farm-border px-2 py-1.5 text-[0.75rem] select-none farm-text" />
                      <button id="incShares"
                        class="rounded-xl border farm-border farm-bg-light px-2 py-1.5 text-[0.75rem] font-semibold active:scale-[0.97] transition farm-text">
                        +
                      </button>
                    </div>
                  </div>
                </div>

                <p id="tradeMessage" class="text-[0.72rem] min-h-[1rem] farm-text-secondary"></p>
              </div>
            </section>

            <section id="positionsSection"
              class="rounded-2xl farm-bg-card border farm-border p-3 flex-1 flex flex-col min-h-0 overflow-hidden hidden md:flex">
              <div class="flex items-center justify-between gap-2 mb-1">
                <div class="flex items-center gap-2">
                  <h3 class="text-xs font-semibold farm-text">Sell</h3>
                  <span id="holdingsSummary" class="text-[0.6rem] farm-text-secondary">No positions</span>
                </div>
                <div class="flex items-center gap-2">
                  <div class="text-right flex flex-col items-end gap-0.5">
                    <div class="text-[0.6rem] uppercase farm-text-secondary">Investment</div>
                    <div class="flex items-center gap-1 leading-none">
                      <div id="tradeInvestChange"
                        class="trade-delta text-[0.65rem] font-semibold text-emerald-300 opacity-0 transition-opacity duration-200 pointer-events-none">
                      </div>
                      <div id="investedValue" class="text-xs font-semibold farm-text">$0.00</div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="flex-1 flex flex-col min-h-0">
                <div
                  class="rounded-lg farm-bg border farm-border flex-1 overflow-y-auto overflow-x-auto offcanvas-scroll">
                  <table class="w-full min-w-full text-[0.75rem]">
                    <thead class="farm-text-secondary text-[0.65rem] sticky top-0 z-10 farm-bg">
                      <tr class="border-b border-neutral-800">
                        <th class="text-left px-2 py-1.5">Shares</th>
                        <th class="text-left px-2 py-1.5">Ticker</th>
                        <th class="text-left px-2 py-1.5">Cost</th>
                        <th class="text-left px-2 py-1.5">Value</th>
                        <th class="text-left px-2 py-1.5">P/L %</th>
                        <th class="text-left px-2 py-1.5">P/L</th>
                        <th class="text-left px-2 py-1.5">Action</th>
                      </tr>
                    </thead>
                    <tbody id="holdingsBody"></tbody>
                  </table>
                </div>

                <div class="flex items-center justify-between pt-1.5 text-[0.65rem]">
                  <button id="prevPage"
                    class="rounded-full border farm-border px-2 py-1 min-w-[3rem] text-center active:scale-[0.97] transition farm-text">
                    Prev
                  </button>
                  <span id="pageInfo" class="farm-text-secondary">Page 1 of 1</span>
                  <button id="nextPage"
                    class="rounded-full border farm-border px-2 py-1 min-w-[3rem] text-center active:scale-[0.97] transition farm-text">
                    Next
                  </button>
                </div>
              </div>
            </section>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="assets/js/firebase-auth.js"></script>
  <script type="module" src="assets/js/pwa.js"></script>
  <script type="module" src="assets/js/app.js"></script>
</body>

</html>
<div id="tradeModal" class="fixed inset-0 z-[70] hidden" role="dialog" aria-modal="true"
    aria-labelledby="tradeModalTitle">
    <div id="tradeOverlay" class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
    <div class="relative z-10 flex min-h-full items-center justify-center px-3 py-6">
        <div
            class="w-full max-w-6xl md:max-w-7xl max-h-[90vh] h-[90vh] farm-bg-card border farm-border rounded-2xl shadow-2xl overflow-hidden flex flex-col">
            <div class="flex items-center justify-between px-5 py-4 border-b farm-border farm-bg">
                <div>
                    <p class="text-[11px] uppercase tracking-wide farm-text-secondary">Trading</p>
                    <h2 id="tradeModalTitle" class="text-lg font-semibold farm-text">Market</h2>
                </div>
                <button id="tradeClose"
                    class="p-2 rounded-full farm-btn farm-text-secondary focus:outline-none border farm-border">
                    <span class="sr-only">Close</span>
                    <svg class="h-4 w-4" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.6">
                        <path d="M5 5l10 10M15 5L5 15" stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <div class="px-5 py-5 farm-bg space-y-3 flex-1 overflow-auto flex flex-col">
                <div class="md:hidden flex rounded-full farm-bg-light p-1 text-[0.7rem]">
                    <button id="tradeTab"
                        class="flex-1 text-center py-1.5 rounded-full font-semibold farm-bg-card farm-text">Buy</button>
                    <button id="positionsTab"
                        class="flex-1 text-center py-1.5 rounded-full font-semibold text-neutral-400">Sell</button>
                </div>

                <div
                    class="mt-1 flex flex-col md:grid md:grid-cols-2 md:gap-3 md:items-stretch flex-1 min-h-0 overflow-hidden">
                    <section id="tradeSection"
                        class="rounded-2xl farm-bg-card border farm-border p-3 flex-1 flex flex-col min-h-0 overflow-hidden">
                        <div class="flex items-center justify-between gap-2 mb-1">
                            <h3 class="text-xs font-semibold farm-text">Buy</h3>
                            <div class="flex items-center gap-2">
                                <div class="text-right flex flex-col items-end gap-0.5">
                                    <div class="text-[0.6rem] uppercase farm-text-secondary">Wallet</div>
                                    <div class="flex items-center gap-1 leading-none">
                                        <div id="tradeMoneyChange"
                                            class="trade-delta text-[0.65rem] font-semibold text-emerald-300 opacity-0 transition-opacity duration-200 pointer-events-none">
                                        </div>
                                        <div class="text-xs font-semibold farm-text" id="tradeWalletValue">$0.00</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex-1 flex flex-col min-h-0">
                            <div
                                class="rounded-lg farm-bg-card border farm-border flex-1 overflow-y-auto offcanvas-scroll">
                                <ul id="tickerList" class="divide-y divide-farm-border text-[0.75rem]"></ul>
                            </div>

                            <div class="space-y-1">
                                <div class="text-[0.65rem] farm-text-secondary">Shares</div>
                                <div class="flex items-stretch gap-2">
                                    <button id="buyBtn"
                                        class="w-32 rounded-xl btn-accent py-1.5 px-3 text-[0.75rem] font-semibold active:scale-[0.98] transition text-left">
                                        Buy
                                    </button>
                                    <div class="flex-1 flex items-center gap-1.5">
                                        <button id="decShares"
                                            class="rounded-xl border farm-border farm-bg-light px-2 py-1.5 text-[0.75rem] font-semibold active:scale-[0.97] transition farm-text">
                                            âˆ’
                                        </button>
                                        <input id="shareInput" type="text" readonly value="1"
                                            class="w-full text-center rounded-xl farm-bg-light border farm-border px-2 py-1.5 text-[0.75rem] select-none farm-text" />
                                        <button id="incShares"
                                            class="rounded-xl border farm-border farm-bg-light px-2 py-1.5 text-[0.75rem] font-semibold active:scale-[0.97] transition farm-text">
                                            +
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <p id="tradeMessage" class="text-[0.72rem] min-h-[1rem] farm-text-secondary"></p>
                        </div>
                    </section>

                    <section id="positionsSection"
                        class="rounded-2xl farm-bg-card border farm-border p-3 flex-1 flex flex-col min-h-0 overflow-hidden hidden md:flex">
                        <div class="flex items-center justify-between gap-2 mb-1">
                            <div class="flex items-center gap-2">
                                <h3 class="text-xs font-semibold farm-text">Sell</h3>
                                <span id="holdingsSummary" class="text-[0.6rem] farm-text-secondary">No positions</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="text-right flex flex-col items-end gap-0.5">
                                    <div class="text-[0.6rem] uppercase farm-text-secondary">Investment</div>
                                    <div class="flex items-center gap-1 leading-none">
                                        <div id="tradeInvestChange"
                                            class="trade-delta text-[0.65rem] font-semibold text-emerald-300 opacity-0 transition-opacity duration-200 pointer-events-none">
                                        </div>
                                        <div id="investedValue" class="text-xs font-semibold farm-text">$0.00</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex-1 flex flex-col min-h-0">
                            <div
                                class="rounded-lg farm-bg border farm-border flex-1 overflow-y-auto overflow-x-auto offcanvas-scroll">
                                <table class="w-full min-w-full text-[0.75rem]">
                                    <thead class="farm-text-secondary text-[0.65rem] sticky top-0 z-10 farm-bg">
                                        <tr class="border-b border-neutral-800">
                                            <th class="text-left px-2 py-1.5">Shares</th>
                                            <th class="text-left px-2 py-1.5">Ticker</th>
                                            <th class="text-left px-2 py-1.5">Cost</th>
                                            <th class="text-left px-2 py-1.5">Value</th>
                                            <th class="text-left px-2 py-1.5">P/L %</th>
                                            <th class="text-left px-2 py-1.5">P/L</th>
                                            <th class="text-left px-2 py-1.5">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="holdingsBody"></tbody>
                                </table>
                            </div>

                            <div class="flex items-center justify-between pt-1.5 text-[0.65rem]">
                                <button id="prevPage"
                                    class="rounded-full border farm-border px-2 py-1 min-w-[3rem] text-center active:scale-[0.97] transition farm-text">
                                    Prev
                                </button>
                                <span id="pageInfo" class="farm-text-secondary">Page 1 of 1</span>
                                <button id="nextPage"
                                    class="rounded-full border farm-border px-2 py-1 min-w-[3rem] text-center active:scale-[0.97] transition farm-text">
                                    Next
                                </button>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>
</div>